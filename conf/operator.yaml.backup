# Operator Console Configuration
# Default settings for FastAPI orchestrator and Gradio UI

server:
  host: "127.0.0.1"  # Default: local-only for security
  port: 8008
  workers: 1
  log_level: "info"
  # Explicit opt-in required for 0.0.0.0 binding
  allow_external_bind: false

security:
  # Bearer token authentication
  admin_token_env: "ADMIN_TOKEN"
  # Default token (change in production)
  default_token: "default-admin-token-change-me"
  
  # Rate limiting for job creation and API endpoints
  rate_limiting:
    enabled: true
    job_creation_per_minute: 5  # Max job creations per minute
    api_requests_per_minute: 60  # Max API requests per minute per client
    burst_size: 10  # Allow burst of requests
  
  # CORS settings (disabled by default for security)
  cors:
    enabled: false
    allow_origins: []  # Empty list = no origins allowed
    allow_credentials: false
    allow_methods: []
    allow_headers: []
    # Additional security headers
    expose_headers: []
    max_age: 86400  # 24 hours
  
  # Security headers
  security_headers:
    enabled: true
    hsts_seconds: 31536000  # 1 year
    content_security_policy: "default-src 'self'"
    x_content_type_options: "nosniff"
    x_frame_options: "DENY"
    x_xss_protection: "1; mode=block"

gates:
  # HITL gate configuration
  script:
    required: true
    auto_approve: false
    auto_approve_after_s: null  # null = no auto-approval, int = seconds to wait
  
  storyboard:
    required: true
    auto_approve: false
    auto_approve_after_s: null
  
  assets:
    required: true
    auto_approve: false
    auto_approve_after_s: null
  
  audio:
    required: true
    auto_approve: false
    auto_approve_after_s: null
  
  # Optional gates
  outline:
    required: false
    auto_approve: true
    auto_approve_after_s: 1800  # 30 minutes
  
  research:
    required: false
    auto_approve: true
    auto_approve_after_s: 2700  # 45 minutes
  
  animatics:
    required: false
    auto_approve: true
    auto_approve_after_s: 5400  # 90 minutes
  
  assemble:
    required: false
    auto_approve: true
    auto_approve_after_s: 7200  # 120 minutes
  
  acceptance:
    required: false
    auto_approve: true
    auto_approve_after_s: 1800  # 30 minutes

storage:
  # Database settings
  db_path: "jobs.db"
  
  # Artifact storage
  runs_dir: "runs"
  artifacts_dir: "artifacts"
  
  # Logging
  events_retention_days: 30
  max_events_per_job: 1000

pipeline:
  # Pipeline execution settings
  max_concurrent_jobs: 1
  job_timeout_hours: 24
  
  # Stage timeouts
  stage_timeouts:
    outline: 30
    research: 45
    script: 60
    storyboard: 120
    assets: 180
    animatics: 90
    audio: 60
    assemble: 120
    acceptance: 30

ui:
  # Gradio UI settings
  enabled: true
  port: 7860
  share: false
  debug: false
  
  # UI features
  features:
    real_time_updates: true
    sse_enabled: true
    polling_fallback: true
    download_artifacts: true
    job_cancellation: true

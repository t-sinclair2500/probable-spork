# Research and trending topics configuration
# This file controls API access, rate limits, and provider settings

# Research policy configuration
policy:
  # Research mode: reuse (cache-first) or live (with API calls)
  mode: "reuse"  # Default to reuse mode for safety
  
  # Provider allowlist and blacklist for research collection
  allow_providers: ["local_fixtures"]
  deny_providers: []
  
  # Grounding settings
  min_citations: 2
  coverage_threshold: 0.65
  fact_guard: "block"  # off | warn | block
  min_domain_score: 0.25



# Domain reputation scores (moved from hardcoded values)
domain_scores:
  "wikipedia.org": 1.0
  "en.wikipedia.org": 1.0
  "nytimes.com": 0.9
  "medium.com": 0.5
  "designmuseum.org": 0.8
  "moma.org": 0.85
  "tate.org.uk": 0.8
  "vam.ac.uk": 0.8
  "cooperhewitt.org": 0.75
  "metmuseum.org": 0.85
  "nga.gov": 0.8
  "si.edu": 0.8
  "britannica.com": 0.85
  "encyclopedia.com": 0.7
  "academic.oup.com": 0.9
  "jstor.org": 0.95
  "arxiv.org": 0.9
  "researchgate.net": 0.7
  "scholar.google.com": 0.8
  "ieee.org": 0.9
  "acm.org": 0.9
  "springer.com": 0.85
  "nature.com": 0.95
  "example.com": 0.2





# API toggles - enable/disable live data sources
apis:
  reddit: false          # Reddit API access
  youtube: false         # YouTube Data API v3
  google_trends: false   # Google Trends API (unofficial)
  twitter: false         # Twitter/X API (if available)

# Domain allowlist and blacklist for research collection
domains:
  allowlist:
    - "wikipedia.org"
    - "en.wikipedia.org"
    - "designmuseum.org"
    - "moma.org"
    - "tate.org.uk"
    - "vam.ac.uk"
    - "cooperhewitt.org"
    - "metmuseum.org"
    - "nga.gov"
    - "si.edu"
    - "britannica.com"
    - "encyclopedia.com"
    - "academic.oup.com"
    - "jstor.org"
    - "arxiv.org"
    - "researchgate.net"
    - "scholar.google.com"
    - "ieee.org"
    - "acm.org"
    - "springer.com"
  
  blacklist:
    - "facebook.com"
    - "twitter.com"
    - "instagram.com"
    - "tiktok.com"
    - "youtube.com"
    - "reddit.com"
    - "quora.com"
    - "medium.com"
    - "substack.com"
    - "tumblr.com"

# Provider-specific settings
providers:
  rate_limits:
    local_fixtures: { min_interval_ms: 0, jitter_ms: 0 }
    bing: { min_interval_ms: 1200, jitter_ms: 200 }
    news: { min_interval_ms: 1500, jitter_ms: 300 }
    reddit: { min_interval_ms: 60000, jitter_ms: 6000 }
    youtube: { min_interval_ms: 6000, jitter_ms: 1200 }
    google_trends: { min_interval_ms: 120000, jitter_ms: 18000 }
    web_scraping: { min_interval_ms: 60000, jitter_ms: 12000 }
  
  reddit:
    subreddits: ["technology", "science", "programming", "mac", "macbook"]
    time_filter: "week"  # hour, day, week, month, year, all
    limit: 25
  
  youtube:
    categories: ["27", "28", "22"]  # Science, People & Blogs, People & Society
    region_code: "US"
    video_duration: "medium"  # short, medium, long
    max_results: 50
  
  google_trends:
    geo: "US"
    time_range: "7d"  # 1h, 4h, 1d, 7d, 1m, 3m, 12m, 5y, 2004-present
    category: "0"  # All categories

# Caching settings
cache:
  ttl_hours: 24          # Time to live for cached data
  max_entries: 1000      # Maximum cached entries per provider
  storage: "database"    # database or json
  disk_cache:
    enabled: true
    base_path: "data/research_cache"
    max_size_mb: 1000
    cleanup_interval_hours: 6

# Research collection settings
collection:
  max_sources_per_topic: 15
  min_content_length: 200
  max_content_length: 50000
  extract_methods:
    - "trafilatura"      # Primary extraction method
    - "beautifulsoup"    # Fallback method
    - "regex"            # Last resort method
  
  # Source scoring weights
  scoring_weights:
    domain_quality: 0.4      # Domain reputation and authority
    recency: 0.3             # How recent the content is
    topical_overlap: 0.3     # Relevance to research topic

# Grounding settings
grounding:
  min_citations_per_beat: 1
  target_citations_per_beat: 2
  min_beats_coverage_pct: 60.0
  citation_format: "[S{num}]"  # Citation marker format
  
  # Quality thresholds
  min_domain_quality_score: 0.6
  min_content_relevance_score: 0.7

# Scoring weights for topic prioritization
scoring:
  recency_weight: 0.4    # How much to favor recent topics
  source_weight: 0.3     # How much to weight different sources
  engagement_weight: 0.3 # How much to weight engagement metrics

# Output settings
output:
  max_topics: 20         # Maximum topics to return
  min_score: 0.1         # Minimum score threshold
  include_metadata: true # Include source and timestamp info

# Fact-guard configuration
fact_guard:
  # Strictness levels for claim processing
  strictness_levels:
    strict:
      description: "Remove all unsupported claims, no exceptions"
      remove_unsupported: true
      rewrite_to_cautious: false
      flag_for_review: false
      require_citation_threshold: 0.1  # Very low threshold
    
    balanced:
      description: "Rewrite unsupported claims to cautious form, flag borderline cases"
      remove_unsupported: false
      rewrite_to_cautious: true
      flag_for_review: true
      require_citation_threshold: 0.3  # Medium threshold
    
    lenient:
      description: "Flag most claims for review, minimal automatic changes"
      remove_unsupported: false
      rewrite_to_cautious: false
      flag_for_review: true
      require_citation_threshold: 0.6  # Higher threshold
  
  # Default strictness level
  default_strictness: "balanced"
  
  # Claim type policies
  claim_policies:
    proper_nouns:
      requires_citation: true
      action: "rewrite"
      rationale: "Proper nouns often represent specific facts requiring verification"
    
    dates:
      requires_citation: true
      action: "rewrite"
      rationale: "Specific dates are factual claims needing source verification"
    
    superlatives:
      requires_citation: true
      action: "rewrite"
      rationale: "Superlatives (first, most, best) are factual claims needing evidence"
    
    statistics:
      requires_citation: true
      action: "remove"
      rationale: "Statistics without sources are unreliable and should be removed"
    
    expert_opinions:
      requires_citation: true
      action: "rewrite"
      rationale: "Expert opinions need attribution to maintain credibility"
    
    general_statements:
      requires_citation: false
      action: "keep"
      rationale: "General observations don't require specific citations"
  
  # Output settings
  output:
    save_cleaned_script: true
    save_detailed_report: true
    include_rationale: true
    include_suggestions: true
    max_examples_per_category: 5

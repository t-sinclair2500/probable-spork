# Unified cron for shared pipeline (YouTube + Blog lanes) on a single Pi.
# Uses orchestrator for single daily run instead of fragmented individual steps.
SHELL=/bin/bash
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin

# Define repo & venv
REPO=~/youtube_onepi_pipeline
PY=$REPO/.venv/bin/python
LOG=$REPO/logs/cron.log

# MAIN ORCHESTRATED PIPELINE (single daily run)
# Runs complete pipeline: ingestion -> YouTube lane -> Blog lane (staged)
0  9  * * *  cd $REPO && source $REPO/.venv/bin/activate && $PY bin/run_pipeline.py >> $LOG 2>&1

# Health monitoring (hourly)
0  *  * * *  cd $REPO && source $REPO/.venv/bin/activate && $PY bin/healthcheck.py >> $REPO/logs/health.log 2>&1

# OPTIONAL: Manual override lanes (comment out for normal operation)
# 30 7  * * *  cd $REPO && source $REPO/.venv/bin/activate && $PY bin/run_pipeline.py --yt-only   >> $LOG 2>&1
# 45 7  * * *  cd $REPO && source $REPO/.venv/bin/activate && $PY bin/run_pipeline.py --blog-only >> $LOG 2>&1
